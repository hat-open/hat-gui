---
"$schema": "http://json-schema.org/schema#"
id: "hat-gui://main.yaml#"
title: GUI server
description: GUI server's configuration
allOf:
  - type: object
    required:
        - type
        - log
        - address
        - adapters
        - views
        - initial_view
        - users
    properties:
        type:
            const: gui
            description: configuration type identification
        version:
            type: string
            description: component version
        log:
            "$ref": "hat-json://logging.yaml#"
        address:
            type: string
            default: "http://127.0.0.1:23023"
        adapters:
            type: array
            items:
                "$ref": "hat-gui://main.yaml#/definitions/adapter"
        views:
            type: array
            items:
                "$ref": "hat-gui://main.yaml#/definitions/view"
        initial_view:
            type:
                - string
                - "null"
        users:
            type: array
            items:
                "$ref": "hat-gui://main.yaml#/definitions/user"
        client:
            type: object
            properties:
                retry_delay:
                    type: number
                ping_delay:
                    type: number
                ping_timeout:
                    type: number
  - oneOf:
      - type: object
        required:
            - monitor
            - event_server_group
        properties:
            monitor:
                "$ref": "hat-monitor://client.yaml#"
            event_server_group:
                type: string
      - type: object
        required:
            - event_server_address
        properties:
            event_server_address:
                type: string
definitions:
    adapter:
        type: object
        required:
            - name
            - module
        properties:
            name:
                type: string
            module:
                type: string
    view:
        allOf:
          - type: object
            required:
                - name
            properties:
                name:
                    type: string
          - oneOf:
              - type: object
                required:
                    - view_path
                properties:
                    view_path:
                        type: string
              - type: object
                required:
                    - builtin
                properties:
                    builtin:
                        type: string
          - oneOf:
              - type: object
                required:
                    - conf_path
                properties:
                    conf_path:
                        type: string
              - type: object
                required:
                    - conf
    user:
        type: object
        required:
            - name
            - password
            - roles
            - view
        properties:
            name:
                type: string
            password:
                "$ref": "hat-gui://main.yaml#/definitions/password"
            roles:
                type: array
                items:
                    type: string
            view:
                type:
                    - string
                    - "null"
    password:
        type: object
        required:
            - hash
            - salt
        properties:
            hash:
                type: string
                description: |
                    SHA256(salt + SHA256(password)) hash encoded as hex string
            salt:
                type: string
                decription: |
                    unique salt used for generating hash encoded as hex string
...
